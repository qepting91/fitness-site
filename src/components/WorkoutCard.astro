---
interface Props {
  title: string;
  subtitle?: string;
  href: string;
  badge?: string;
  badgeColor?: 'violet' | 'emerald' | 'amber' | 'sky';
  exerciseCount?: number;
  difficulty?: 'beginner' | 'intermediate' | 'advanced';
  duration?: number;
  muscleGroups?: string[];
  structure?: string;
  isToday?: boolean;
}

const {
  title,
  subtitle,
  href,
  badge,
  badgeColor = 'violet',
  exerciseCount,
  difficulty,
  duration,
  muscleGroups,
  structure,
  isToday = false
} = Astro.props;

const badgeColors = {
  violet: 'bg-violet-500/20 text-violet-400 border-violet-500/30',
  emerald: 'bg-emerald-500/20 text-emerald-400 border-emerald-500/30',
  amber: 'bg-amber-500/20 text-amber-400 border-amber-500/30',
  sky: 'bg-sky-500/20 text-sky-400 border-sky-500/30',
};

const difficultyColors = {
  beginner: 'bg-emerald-500/20 text-emerald-400',
  intermediate: 'bg-amber-500/20 text-amber-400',
  advanced: 'bg-rose-500/20 text-rose-400',
};

const difficultyLabels = {
  beginner: 'Beginner',
  intermediate: 'Intermediate',
  advanced: 'Advanced',
};
---

<a
  href={href}
  class={`card-interactive block p-4 ${isToday ? 'ring-2 ring-violet-500/50 bg-violet-950/30' : ''}`}
>
  <div class="flex items-start justify-between gap-3">
    <div class="flex-1 min-w-0">
      <div class="flex items-center gap-2 mb-1 flex-wrap">
        {isToday && (
          <span class="badge bg-violet-500/30 text-violet-300 border border-violet-500/40 text-[10px] uppercase tracking-wide font-bold">Today</span>
        )}
        {badge && (
          <span class={`badge border ${badgeColors[badgeColor]}`}>{badge}</span>
        )}
        <h3 class="font-semibold text-slate-100 truncate">{title}</h3>
      </div>
      {subtitle && (
        <p class="text-sm text-slate-400 line-clamp-2">{subtitle}</p>
      )}

      <!-- Metadata Row -->
      <div class="flex flex-wrap items-center gap-2 mt-3">
        {difficulty && (
          <span class={`text-xs px-2 py-0.5 rounded-full ${difficultyColors[difficulty]}`}>
            {difficultyLabels[difficulty]}
          </span>
        )}
        {duration && (
          <span class="text-xs text-slate-500 flex items-center gap-1">
            <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            {duration} min
          </span>
        )}
        {exerciseCount !== undefined && (
          <span class="text-xs text-slate-500">{exerciseCount} exercises</span>
        )}
        {structure && (
          <span class="text-xs text-slate-500 capitalize">{structure.replace('-', ' ')}</span>
        )}
      </div>

      <!-- Muscle Groups -->
      {muscleGroups && muscleGroups.length > 0 && (
        <div class="flex flex-wrap gap-1 mt-2">
          {muscleGroups.slice(0, 4).map(muscle => (
            <span class="text-[10px] px-1.5 py-0.5 rounded bg-slate-800/60 text-slate-400 capitalize">
              {muscle.replace('-', ' ')}
            </span>
          ))}
        </div>
      )}
    </div>
    <svg class="w-5 h-5 text-slate-500 flex-shrink-0 mt-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
    </svg>
  </div>
</a>
